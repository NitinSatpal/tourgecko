<div class="hostHome">
	<div class="row body-content">
		<div ng-include="'/modules/hosts/client/views/side-nav.client.view.html'"></div>

		<div class="col-md-9 col-sm-9 col-lg-10 home-content">
			<div ng-include="'/modules/hosts/client/views/top-nav-home.client.view.html'"></div>

			<div class="home-section analytics">
				<div class="head_content">
					<h3>Analytics</h3>
					<p>Last 30 days</p>
				</div>
				<!-- We are suppose to give the analytics for last 30 days as per written in heading. For now, its overall. Will
					 check whether I need to change it to last 30 days or we will change the heading to total -->
				<div class="row">
					<div class="col-lg-3 col-md-3 col-sm-3 col-xs-6 analytics-bookings">
						<i class="zmdi zmdi-account"></i>
						<p ng-show="vm.bookings.length > 1"><span>{{vm.bookings.length}}</span> Bookings</p>
						<p ng-show="vm.bookings.length == 1"><span>{{vm.bookings.length}}</span> Booking</p>
					</div>
					<div class="col-lg-3 col-md-3 col-sm-3 col-xs-6 revenue">
						<i class="zmdi zmdi-money"></i>
						<p><span>{{vm.totalRevenue}}</span> Revenue</p>
					</div>
					<div class="col-lg-3 col-md-3 col-sm-3 col-xs-6 messages">
						<i class="zmdi zmdi-email"></i>
						<p ng-show="vm.messages.length > 1"><span>{{vm.messages.length}}</span> Messages</p>
						<p ng-show="vm.messages.length == 1"><span>{{vm.messages.length}}</span> Message</p>
					</div>
					<div class="col-lg-3 col-md-3 col-sm-3 col-xs-6 departures">
						<i class="zmdi zmdi-airplane"></i>
						<p><span>{{vm.productSessions.length}}</span> Departures</p>
					</div>
				</div>
			</div>
			<div class="home-section pinboard">
				<div class="head_content">
					<h3>Pinboard</h3>
				</div>
				<div class="row">
					<div class="col-lg-12 col-sm-12">
						<div class="info_content">
							<div class="info">
								<p>Complete your profile information</p>
								<p class="todo text-uppercase"><i class="zmdi zmdi-assignment"></i> todo</	p>
								<p class="time"><i class="zmdi zmdi-timer"></i> 2Min</p>
							</div>
							<a class="update_profile btn btn-default pull-right" href="#">Update Profile</a>
						</div>
					</div>
				</div>
				<div class="row">
					<div class="col-lg-12 col-sm-12">
						<div class="info_content">
							<div class="info">
								<p>Long weekend is coming, have you planned any tours ?</p>
								<p class="todo text-uppercase"><i class="zmdi zmdi-lamp invert"></i> advice</p>
							</div>
							<a class="dismiss " href="#">Dismiss</a>
						</div>
					</div>
				</div>
			</div>
			<div class="home-section latest">
				<div class="head_content">
					<h3>Latest</h3>
				</div>
				<div class="row">
					<div class="col-lg-6 col-mg-6 col-sm-6 bookings">
						<h4>Bookings</h4>
						<div class="info_content" ng-repeat="booking in vm.bookings | limitTo:5">
							<p class="name">{{booking.numberOfBookings}}</p>
							<p class="outing">Trek to bandghavgad</p>
							<p class="date">20 Jan, 2016</p>
							<p class="status text-uppercase"><i class="zmdi zmdi-star-outline"></i> New</p>
						</div>
					<div class="seemoreinfo">
							<a ui-sref="host.allBookings" ng-show="vm.bookings.length > 5">See all Bookings</a>
							<a ui-sref="host.allBookings" ng-show="vm.bookings.length < 5">Go to Bookings</a>
						</div>	
					</div>
					
					<div class="col-lg-6 col-mg-6 col-sm-6 message">
						<h4>Messages</h4>
						<div class="info_content" ng-repeat="message in vm.messages | limitTo:5">
							<p class="name">{{message.messageFrom}}</p>
							<p class="content">Lorem ipsum dolor sit amet, consectetur adipiscing elit</p>
							<p class="status"><i class="zmdi zmdi-email"></i></p>
						</div>
						
						<div class="seemoreinfo">
							<a ui-sref="host.allMessages" ng-show="vm.messages.length > 5">See all Messages</a>
							<a ui-sref="host.allMessages" ng-show="vm.messages.length < 5">Go to Messages</a>
						</div>
					</div>
				</div>
			</div>
			<div class="home-section event_calendar">
				<div class="head_content">
					<h3>Upcoming</h3>
				</div>
				<div class="row">
					<div class="col-lg-12">
						<div id='calendar'></div>
					</div>
				</div>
			</div>
			<div class="footer" ng-include="'/modules/hosts/client/views/footer-host.client.view.html'">
			</div>
		</div>
	</div>
</div>
<div id="fullCalModal" class="modal fade">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">Ã—</span> <span class="sr-only">close</span></button>
				<h4 id="modalTitle" class=""></h4>
			</div>
			<div id="modalBody" class="modal-body"></div>
			<div class="modal-footer">
				<button class="btn btn-primary"><a id="eventUrl" target="_blank" href="#">Details</a></button>
			</div>
		</div>
	</div>
</div>
<script>
	$(document).ready(function() {
		var events = [];
		$.ajax({
	      url:'/api/host/product',
	        type:'GET',
	        dataType: 'json',
	      success: function( json ) {
	      	var cssCounter = 0;
	        $.each(json, function(index, document) {
	        	if (cssCounter == 0) {
	        		events.push	({title: '<span class="eventname orange">' + document.productTitle + '</span><span class="lbreak"><i class="zmdi zmdi-circle orange"></i><i class="zmdi zmdi-account"></i>7/10</span>' , start: document.productStartDate, end: document.productEndDate, backgroundColor: 'rgba(237,156,40, 0.2)'});
	        		cssCounter++;
	        	} else if (cssCounter == 1) {
	        		events.push	({title: '<span class="eventname green">' + document.productTitle + '</span><span class="lbreak"><i class="zmdi zmdi-circle green"></i><i class="zmdi zmdi-account"></i>7/10</span>' , start: document.productStartDate, end: document.productEndDate, backgroundColor: 'rgba(66,174,94,0.2)'});
	        		cssCounter++;
	        	} else {
	        		events.push	({title: '<span class="eventname red">' + document.productTitle + '</span><span class="lbreak"><i class="zmdi zmdi-circle red"></i><i class="zmdi zmdi-account"></i>7/10</span>' , start: document.productStartDate, end: document.productEndDate, backgroundColor: 'rgba(216,64,64,0.2)'});
	        		cssCounter = 0;
	        	}
	        });
            $('#calendar').fullCalendar({
				header: {
					left: 'prev,next today',
					center: 'title',
					right: 'month,agendaWeek,agendaDay'
				},
				navLinks: true, // can click day/week names to navigate views
				selectable: true,
				selectHelper: true,
				select: function(start, end) {
					var title = prompt('Event Title:');
					var eventData;
					if (title) {
						eventData = {
							title: title,
							start: start,
							end: end
						};
						$('#calendar').fullCalendar('renderEvent', eventData, true); // stick? = true
					}
					$('#calendar').fullCalendar('unselect');
				},
				editable: true,
				eventLimit: true, // allow "more" link when too many events
				events: events,
				eventRender: function (event, element) {
					element.find('.fc-title').html(event.title);
				},
				eventClick:  function(event, jsEvent, view) {
					var months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'June', 'July', 'Aug', 'Sept', 'Oct', 'Nov', 'Dec'];
					var date1 = new Date(event._start._i);
					var date2 = new Date(event._end._i);
					var hours1 = date1.getHours();
					var ampm1 = (hours1 >= 12)? 'pm' : 'am';
					hours1 = (hours1 > 12)? hours1 -12 : hours1;
					var hours2 = date2.getHours();
					var ampm2 = (hours2 >= 12)? 'pm' : 'am';
					hours2 = (hours2 > 12)? hours2 -12 : hours2;
					var mins1 = date1.getMinutes();
					var mins2 = date2.getMinutes();
					var s_date = date1.getDate()+" "+months[new Date(event._start._i).getMonth()]+" "+hours1+":"+mins1+ampm1;
					var e_date = date2.getDate()+" "+months[new Date(event._end._i).getMonth()]+" "+hours2+":"+mins2+ampm2;
					var timeDiff = Math.abs(date2.getTime() - date1.getTime());
					var diffDays = Math.ceil(timeDiff / (1000 * 3600 * 24));
					
					var event_name = $(jsEvent.currentTarget).find(".eventname").text();
					var event_color = $(jsEvent.currentTarget).find(".eventname").attr("class").split(" ")[1];
					console.log(event_color);
					var bookings = $(jsEvent.currentTarget).find(".lbreak").text().split("/")[0]+" Bookings";
					var duration_date = s_date+"-"+e_date;
					var duration_days = diffDays+" Days";
					
					var html = "<p><i class='zmdi zmdi-calendar'></i> "+duration_date+"</p><p><i class='zmdi zmdi-time'></i> "+duration_days+"</p><p><i class='zmdi zmdi-calendar-check'></i> Fixed Dates</p><p><i class='zmdi zmdi-account'></i> "+bookings+"</p>";
					
					
					$('#modalTitle').html("<i class='zmdi zmdi-circle'></i> "+event_name).attr("class","").addClass(event_color);
					$('#modalBody').html(html);
					$('#eventUrl').attr('href',event.url);
					$('#fullCalModal').modal();
				}
			});
	      }
	    });
	});
</script>
<script>
	$(".navbar-toggle").click(function(e){
		e.preventDefault();
		if($("li[data-toggle='slide-collapse']").hasClass("toggle")){
			$("li[data-toggle='slide-collapse']").removeClass("toggle");
		}else{
			$(".main-wrapper").toggleClass("toggle");
		}
		e.stopPropagation();
	});
	$("li[data-toggle='slide-collapse']").click(function(e){
		e.stopPropagation();
		$(this).toggleClass("toggle");
	});
	$(".sub-menu").click(function(e){
		e.stopPropagation();
	});
	$(document).click(function () {
		if($("li[data-toggle='slide-collapse']").hasClass("toggle")){
			$("li[data-toggle='slide-collapse']").removeClass("toggle");
		}else{
			$(".main-wrapper").removeClass("toggle");
		}
	});
</script>